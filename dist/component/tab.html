<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>mobile触摸页面-滑动的tab</title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<style>
			.mobile-tab-slide .mobile-scroll-content {
				padding: 5px;
			}
			
			p {
				line-height: 28px;
				font-size: 16px;
				padding: 5px ;
				background: #fafafa;
				margin-bottom: 5px;
				border-radius: 5px;
				
			}
			.mobile-head2
			{position: fixed;
				top:0;
				left: 0;
				z-index: 99998;
				width: 100%;
			height: 40px;
			 background: red;;
			}
		</style>

		<link rel="stylesheet" type="text/css" href="../css/mobile.css" />

	</head>

	<body>
		<!--head-->
		<div class="mobile-head">
			<h2 class="mobile-head-ttl">滑动的tab 标签</h2>
		</div>
		<!--定位到顶部-->
		<div class="mobile-tab mobile-tab-top">
			<!--左右滑动组建  data-position-left=定位到left data-position-center=定位到center data-trigger=允许触发scrollbottom事件 -->
			<nav class="mobile-tab-nav mobile-scroll-leftright" data-position-center data-trigger>
				<ul class="mobile-scroll-content">
					<li class="active" data-target="#page1">
						第1屏
					</li>
					<li data-target="#page2">
						第2屏
					</li>
					<li data-target="#page3">
						第3屏
					</li>
					<li data-target="#page4">
						第4屏
					</li>
					<li data-target="#page5">
						第5屏
					</li>
					<li data-target="#page6">
						第6屏
					</li>
					<li data-target="#page7">
						第7屏
					</li>
					<li data-target="#page8">
						第8屏
					</li>
					<li data-target="#page9">
						第9屏
					</li>
					<li data-target="#page10">
						第10屏
					</li>

				</ul>
			</nav>

		</div>

		<!--content-->
		<section class="mobile-content">
			<!--tab 左右滑动内容 data-drag=左右两边回弹  data-transition="是否左右滑动动画"  data-trigger=允许触发scrollbottom事件 -->
			<div class="mobile-tab-slide" data-transition="是否左右滑动动画" data-drag data-trigger>
				<div class="mobile-tab-slide-list">
					<div id="page1" class="mobile-tab-slide-item  mobile-scroll-topbottom" data-scroll-bar data-scroll-bottom>
						<div class="mobile-scroll-content">

							<p>第1屏</p>
							
						
						</div>
					</div>

					<div id="page2" class="mobile-tab-slide-item mobile-scroll-topbottom" data-scroll-bar data-scroll-bottom>
						<div class="mobile-scroll-content">
							<p>第2屏</p>
							
							
						</div>

					</div>

					<div id="page3" class="mobile-tab-slide-item mobile-scroll-topbottom" data-scroll-bar data-scroll-bottom>
						<div class="mobile-scroll-content">
							<p>第3屏</p>
							
							
						</div>
					</div>

					<div id="page4" class="mobile-tab-slide-item mobile-scroll-topbottom" data-scroll-bar data-scroll-bottom>
						<div class="mobile-scroll-content">
							<p>第4屏</p>
							

							
						</div>
					</div>
					
					<div id="page5" class="mobile-tab-slide-item mobile-scroll-topbottom" data-scroll-bar data-scroll-bottom>
						<div class="mobile-scroll-content">
							<p>第5屏</p>
						
						</div>
					</div>

					<div id="page6" class="mobile-tab-slide-item mobile-scroll-topbottom" data-scroll-bar data-scroll-bottom>
						<div class="mobile-scroll-content">
							<p>第6屏</p>
							
						</div>
					</div>

					<div id="page7" class="mobile-tab-slide-item mobile-scroll-topbottom" data-scroll-bar data-scroll-bottom>
						<div class="mobile-scroll-content">
							<p>第7屏</p>
							
						</div>
					</div>
					<div id="page8" class="mobile-tab-slide-item mobile-scroll-topbottom" data-scroll-bar data-scroll-bottom>
						<div class="mobile-scroll-content">
							<p>第8屏</p>
							
						</div>
					</div>
					<div id="page9" class="mobile-tab-slide-item mobile-scroll-topbottom" data-scroll-bar data-scroll-bottom>
						<div class="mobile-scroll-content">
							<p>第9屏</p>
							
						</div>
					</div>
					<div id="page10" class="mobile-tab-slide-item mobile-scroll-topbottom" data-scroll-bar data-scroll-bottom>
						<div class="mobile-scroll-content">
							<p>第10屏</p>

						</div>
					</div>

				</div>

			</div>

		</section>

		<!--定位到底部-->
		<!--<div class="mobile-tab mobile-tab-bottom">
			<nav class="mobile-tab-nav">
				<div class="mobile-tab-item width-2-5 active">
					<span>首页</span>
				</div>

				<div class="mobile-tab-item width-2-5">
					<span class="">电话</span>
				</div>

				<div class="mobile-tab-item width-2-5">
					<span>邮件</span>
				</div>
				<div class="mobile-tab-item width-2-5">
					<span>设置</span>
				</div>

			</nav>

		</div>-->
		<!--<div class="mobile-tab mobile-tab-bottom">
			<nav class="mobile-tab-nav">
				<div class="mobile-tab-item width-2-5 active">
					<span>首页</span>
				</div>

				<div class="mobile-tab-item width-2-5">
					<span class="">电话</span>
				</div>

				<div class="mobile-tab-item width-2-5">
					<span>邮件</span>
				</div>
				<div class="mobile-tab-item width-2-5">
					<span>设置</span>
				</div>

			</nav>

		</div>-->

		<!--footer-->
		<!--<footer class="mobile-footer">
				<h2>页脚</h2>
		</footer>-->

		<script type="text/html" id="must">
			{{#must}}
			
				<p>{{content}}</p>
		
			{{/must}}
		</script>
		<script src="../js/mobile.js" type="text/javascript" charset="utf-8"></script>
		<script src="../js/mustache.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			m(function(){
	
			// 拉到底部 加载数据
			
			m(".mobile-tab-slide-item.mobile-scroll-topbottom").on("scrollbottom", function(event) {
				var bottomcontent =m(event.detail.el);
				//	console.log(event.detail);
				if(!bottomcontent.hasAttr("firstbottom")) {
					bottomcontent.attr("firstbottom",true); //异步加载标识
					
					bottomcontent.find(".loading").remove();
					var loading = document.createElement("div");
					loading.innerHTML = "正在加载中...";
					loading.classList.add("loading");
					bottomcontent.append(loading);
					
					setTimeout(function() {

						m.get("../json/tab.json", function(data) {
							data=data.map(function(item){return {content:bottomcontent.parent().attr("id")+"#"+item.content};});
							
							var html = Mustache.to_html($("#must").html(), {
								must:data 
							});
							bottomcontent.find(".loading").remove();
							bottomcontent.append(html);
							firstbottom = true;
							if(event.detail.resetBar)
							{
								event.detail.resetBar(); // 重置滚动条
							}
							bottomcontent.attr("data-trigger", true); // 标记元素第一次已触发过
							bottomcontent.removeAttr("firstbottom") ;//异步加载标识
							
						}, function() {
							bottomcontent.removeAttr("firstbottom") ;//异步加载标识
							loading.innerHTML = "数据加载失败...";
						});
					}, 500);
				}

			});
				
				// 第一屏 第一次出发触发scrollbottom
				m("#page1").emit("scrollbottom", {
					el: m("#page1").find(".mobile-scroll-content").eq(0)
				});
			
				});
		</script>

	</body>

</html>